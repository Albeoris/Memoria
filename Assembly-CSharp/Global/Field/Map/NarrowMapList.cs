using System;
using System.Collections.Generic;
using Memoria;

public static class NarrowMapList
{
    /// <summary>is mapId <= ScreenWidth</summary>
    public static Boolean IsCurrentMapNarrow(Int32 ScreenWidth)
    {
        Int32 mapId = FF9StateSystem.Common.FF9.fldMapNo;
        if (MapWidth(mapId) <= ScreenWidth)
            return true;

        return false;
    }

    public static Boolean SpecificScenesNarrow(Int32 mapId)
    {
        if (PersistenSingleton<EventEngine>.Instance.eBin == null)
            return false;
        Int32 currIndex = PersistenSingleton<EventEngine>.Instance.eBin.getVarManually(EBin.MAP_INDEX_SVR);
        Int32 currCounter = PersistenSingleton<EventEngine>.Instance.eBin.getVarManually(EBin.SC_COUNTER_SVR);

        //return RestrictedWidthScenesList.Any(entry => entry[0] == mapId && (entry[1] == currIndex || entry[2] == currCounter));
        foreach (Int32[] entry in RestrictedWidthScenesList)
            if (entry[0] == mapId && (FieldMap.ActualPsxScreenWidth > entry[1] || entry[1] == -5) && (entry[2] == currIndex || entry[2] == -5) && (entry[3] == currCounter || entry[3] == -5))
                return true;
        return false;
    }

    public static Int32 MapWidth(Int32 mapId)
    {
        if (SpecificScenesNarrow(mapId))
            return 320;

        //return MapWidthList.FirstOrDefault(entry => entry[0] == mapId)?[1] ?? 500;
        foreach (Int32[] entry in MapWidthList)
            if (entry[0] == mapId)
                return entry[1];

        return 500;
    }

    /// <summary>Make these scenes widescreen (based on index [1] or counter [2]), -5 is ignored</summary>
    public static readonly Int32[][] RestrictedWidthScenesList =
    {
        // [mapNo, max screenwidth, EBin.MAP_INDEX_SVR, EBin.SC_COUNTER_SVR], 
        [50, 478, -5, -5],
        [70, 478, -5, -5],
        [507, 478, -5, -5],
        [600, 432, 0, 3180],

        [150, -5, 325, -5],       // Zidane infiltrate Alex Castle - better in narrow for the "Alex" text
        [254, -5, 26, -5],        // MBG103 - Evil Forest
        [352, -5, 3, -5],         // Arrival at Dali: vivi visible before sleeping
        [615, -5, 58, 3140],      // Lindblum tower scene part 2
        [1554, -5, -5, 6300],     // MBG109 - roots
        [1554, -5, -5, 6305],     // MBG109 - roots
        [1602, -5, 16, -5],       // scene at Madain Sari night w/ Vivi/Zidane/Eiko eavesdropping
        [1652, -5, -5, 6700],     // Iifa entrance
        [1652, -5, -5, 6710],     // Iifa entrance
        [1807, -5, -5, 8500],     // Cid etc. arrival at Alexandria attack
        [1807, -5, -5, 8600],     // Cid etc. arrival at Alexandria attack
        [2007, -5, -5, 8340],     // MBG111 - Alex castle changing
        [2007, -5, -5, 8400],     // MBG111 - Alex castle changing
        [2404, -5, 25, -5],       // Baku seen waiting on the docks too soon
        [2705, -5, -1, -5],       // Pandemonium,  you're not alone sequence,  several glitches
        [2706, -5, -1, -5],       // Pandemonium,  you're not alone sequence,  several glitches
        [2707, -5, -1, -5],       // Pandemonium,  you're not alone sequence,  several glitches
        [2708, -5, -1, -5],       // Pandemonium,  you're not alone sequence,  several glitches
        [2711, -5, 0, -5],        // Pandemonium,  people are waiting in line after Kuja is defeated
        [2905, -5, -5, 11620],    // MBG118 - Memoria pink castle
    };

    /// <summary>List of fields with narrower cams than widescreen, [field#, cam#, PSXWidth]</summary>
    public static readonly Int32[][] RestrictedCams =
    {
        // [mapNo,cam,width],
        [50,1,320],
        [63,0,320],
        [116,1,320],
        [153,0,320],
        [154,0,352],
        [355,1,320],
        [600,1,320],
        [615,1,320],
        [801,1,336],
        [932,1,320],
        [951,1,336],
        [1205,1,384],
        [1206,1,320],
        [1214,0,320],
        [1215,0,352],
        [1462,0,320],
        //[1652,1,336], // resorted back to limiting the scene, as there's still a ~23px offset with 3D objects
        [1759,1,336],
        [1801,1,320],
        [1806,0,320],
        [1807,0,352],
        //[1823,1,320],
        [2150,1,320],
        [2172,1,320],
        [2217,1,320],
        [2217,2,320],
        [2363,0,384],
        [2363,1,336],
        //[2510,0,320],
        [2755,1,336],
    };

    /// <summary>List of fields of width smaller than widescreen, [field#,PSXWidth]</summary>
    public static readonly Int32[][] MapWidthList =
    {
        [50,480],
        [51,480],
        [52,320],
        [53,320],
        [54,432],
        [55,398],
        [56,320],
        [57,448],
        [58,320],
        [59,320],
        [60,366],
        [61,320],
        [62,320],
        [63,320],
        [64,480],
        [65,320],
        [66,320],
        [67,320],
        [68,320],
        [69,320],
        [100,320],
        [101,640],
        [102,382],
        [103,624],
        [104,320],
        [105,320],
        [106,528],
        [107,480],
        [108,320],
        [109,382],
        [110,432],
        [111,448],
        [112,560],
        [113,480],
        [114,350],
        [115,432],
        [116,416],
        [117,416],
        [150,366],
        [151,320],
        [152,800],
        [153,432],
        [154,640],
        [155,416],
        [156,640],
        [157,398],
        [158,480],
        [159,416],
        [160,320],
        [161,366],
        [162,382],
        [163,318],
        [164,318],
        [165,320],
        [166,320],
        [167,320],
        [200,480],
        [201,366],
        [202,480],
        [203,334],
        [204,480],
        [205,320],
        [206,382],
        [207,382],
        [208,480],
        [209,320],
        [250,480],
        [251,382],
        [252,382],
        [253,480],
        [254,398],
        [255,320],
        [256,320],
        [257,416],
        [258,480],
        [259,320],
        [261,320],
        [262,366],
        [300,320],
        [301,320],
        [302,480],
        [303,592],
        [304,432],
        [305,320],
        [306,320],
        [307,464],
        [308,320],
        [309,320],
        [310,320],
        [311,320],
        [312,478],
        [350,448],
        [351,480],
        [352,480],
        [353,416],
        [354,320],
        [355,416],
        [356,416],
        [357,320],
        [358,320],
        [359,320],
        [400,320],
        [401,640],
        [402,480],
        [403,640],
        [404,432],
        [405,398],
        [406,480],
        [407,382],
        [408,448],
        [450,432],
        [451,480],
        [452,320],
        [453,320],
        [454,320],
        [455,318],
        [456,398],
        [457,320],
        [500,320],
        [501,512],
        [502,320],
        [503,320],
        [504,430],
        [505,398],
        [506,320],
        [507,512],
        [550,350],
        [551,320],
        [552,448],
        [553,382],
        [554,480],
        [555,480],
        [556,382],
        [557,480],
        [558,416],
        [559,512],
        [560,320],
        [561,398],
        [562,416],
        [563,432],
        [564,432],
        [565,366],
        [566,398],
        [567,320],
        [568,398],
        [569,398],
        [570,320],
        [571,398],
        [572,416],
        [573,432],
        [574,320],
        [575,416],
        [576,320],
        [600,448],
        [601,320],
        [602,480],
        [603,544],
        [604,448],
        [605,432],
        [606,318],
        [607,320],
        [608,448],
        [609,320],
        [610,448],
        [611,576],
        [612,544],
        [613,398],
        [614,544],
        [615,512],
        [616,480],
        [617,544],
        [618,464],
        [619,432],
        [620,350],
        [650,512],
        [651,640],
        [652,480],
        [653,640],
        [654,640],
        [655,512],
        [656,398],
        [657,398],
        [658,398],
        [659,398],
        [660,640],
        [661,432],
        [662,448],
        [663,398],
        [701,320],
        [702,624],
        [703,576],
        [704,576],
        [705,382],
        [706,448],
        [707,480],
        [750,320],
        [751,382],
        [752,480],
        [753,398],
        [754,320],
        [755,398],
        [756,416],
        [757,480],
        [758,320],
        [759,418],
        [760,334],
        [761,544],
        [762,544],
        [763,416],
        [764,320],
        [765,320],
        [766,320],
        [767,320],
        [768,448],
        [800,320],
        [801,560],
        [802,350],
        [803,350],
        [804,432],
        [805,608],
        [806,398],
        [807,432],
        [808,608],
        [809,512],
        [810,576],
        [811,512],
        [812,512],
        [813,382],
        [814,334],
        [815,416],
        [816,334],
        [850,512],
        [851,398],
        [852,480],
        [853,512],
        [854,512],
        [855,398],
        [856,480],
        [900,448],
        [901,398],
        [902,752],
        [903,768],
        [904,576],
        [905,640],
        [906,512],
        [907,416],
        [908,432],
        [909,592],
        [910,448],
        [911,366],
        [912,640],
        [913,398],
        [914,576],
        [915,416],
        [916,464],
        [930,320],
        [931,318],
        [932,416],
        [950,382],
        [951,512],
        [952,512],
        [953,448],
        [954,320],
        [955,320],
        [956,448],
        [1000,320],
        [1001,320],
        [1002,320],
        [1003,320],
        [1004,512],
        [1005,512],
        [1006,320],
        [1007,320],
        [1008,416],
        [1009,320],
        [1010,640],
        [1011,528],
        [1012,464],
        [1013,320],
        [1014,640],
        [1015,528],
        [1016,528],
        [1017,382],
        [1018,382],
        [1050,316],
        [1051,416],
        [1052,592],
        [1053,608],
        [1054,398],
        [1055,478],
        [1056,464],
        [1057,560],
        [1058,380],
        [1059,526],
        [1060,640],
        [1100,320],
        [1101,416],
        [1102,592],
        [1103,608],
        [1104,398],
        [1105,480],
        [1106,464],
        [1107,560],
        [1108,380],
        [1109,528],
        [1110,638],
        [1150,320],
        [1151,334],
        [1152,448],
        [1153,398],
        [1200,320],
        [1201,382],
        [1202,432],
        [1203,432],
        [1204,480],
        [1205,416],
        [1206,416],
        [1207,480],
        [1208,320],
        [1209,640],
        [1210,382],
        [1211,448],
        [1212,350],
        [1213,366],
        [1214,432],
        [1215,640],
        [1216,416],
        [1217,640],
        [1218,398],
        [1219,480],
        [1220,416],
        [1221,320],
        [1222,366],
        [1223,416],
        [1224,528],
        [1225,416],
        [1226,320],
        [1227,480],
        [1250,320],
        [1251,366],
        [1252,320],
        [1253,320],
        [1254,366],
        [1255,432],
        [1256,432],
        [1300,350],
        [1301,320],
        [1302,448],
        [1303,382],
        [1304,480],
        [1305,480],
        [1306,416],
        [1307,512],
        [1308,320],
        [1309,416],
        [1310,432],
        [1311,432],
        [1312,366],
        [1313,398],
        [1314,320],
        [1315,480],
        [1350,320],
        [1351,320],
        [1352,480],
        [1353,544],
        [1354,448],
        [1355,432],
        [1356,320],
        [1357,320],
        [1358,448],
        [1359,320],
        [1360,448],
        [1361,576],
        [1362,544],
        [1363,398],
        [1364,544],
        [1365,512],
        [1366,480],
        [1367,544],
        [1368,464],
        [1369,432],
        [1370,350],
        [1400,640],
        [1401,320],
        [1402,640],
        [1403,366],
        [1404,382],
        [1405,528],
        [1406,320],
        [1407,512],
        [1408,398],
        [1409,512],
        [1410,320],
        [1411,496],
        [1412,640],
        [1413,512],
        [1414,398],
        [1415,512],
        [1416,640],
        [1417,528],
        [1418,512],
        [1419,608],
        [1420,448],
        [1421,512],
        [1422,528],
        [1423,800],
        [1424,398],
        [1425,480],
        [1450,480],
        [1451,432],
        [1452,382],
        [1453,382],
        [1454,512],
        [1455,320],
        [1456,398],
        [1457,320],
        [1458,334],
        [1459,320],
        [1460,512],
        [1461,320],
        [1462,512],
        [1463,320],
        [1464,320],
        [1500,334],
        [1501,528],
        [1502,416],
        [1503,416],
        [1504,512],
        [1505,512],
        [1506,334],
        [1507,318],
        [1508,350],
        [1509,382],
        [1550,576],
        [1551,416],
        [1552,416],
        [1553,624],
        [1554,464],
        [1555,640],
        [1556,320],
        [1557,320],
        [1600,398],
        [1601,398],
        [1602,398],
        [1603,512],
        [1604,320], // 398 camera problems
        [1605,334],
        [1606,334],
        [1607,320],
        [1608,334],
        [1609,320],
        [1610,320],
        [1650,350],
        [1651,434],
        [1652,480],
        [1653,512],
        [1654,512],
        [1655,320],
        [1656,382],
        [1657,346],
        [1658,320],
        [1659,480],
        [1660,334],
        [1661,334],
        [1662,334],
        [1663,320],
        [1700,398],
        [1701,398],
        [1702,398],
        [1703,512],
        [1704,398],
        [1705,334],
        [1706,320],
        [1707,334],
        [1750,320],
        [1751,334],
        [1752,350],
        [1753,320],
        [1754,320], // 398 scrolling problems
        [1755,320],
        [1756,320],
        [1757,350],
        [1758,434],
        [1759,480],
        [1800,320],
        [1801,416],
        [1802,480],
        [1803,366],
        [1805,352],
        [1806,432],
        [1807,640],
        [1808,416],
        [1809,640],
        [1810,398],
        [1811,480],
        [1812,416],
        [1813,320],
        [1814,366],
        [1815,416],
        [1816,416],
        [1817,366],
        [1818,320],
        [1819,416],
        [1820,382],
        [1821,528],
        [1822,320],
        [1823,320], //432],
        [1824,480],
        [1850,320],
        [1851,640],
        [1852,382],
        [1853,624],
        [1854,320],
        [1855,528],
        [1856,480],
        [1857,320],
        [1858,382],
        [1859,432],
        [1860,448],
        [1861,560],
        [1862,480],
        [1863,350],
        [1864,416],
        [1865,432],
        [1866,320],
        [1900,448],
        [1901,398],
        [1902,752],
        [1903,768],
        [1904,576],
        [1905,640],
        [1906,512],
        [1907,416],
        [1908,432],
        [1909,592],
        [1910,448],
        [1911,366],
        [1912,640],
        [1913,398],
        [1914,576],
        [1915,416],
        [1950,496],
        [1951,350],
        [1952,350],
        [1953,366],
        [2000,350],
        [2001,480],
        [2002,366],
        [2003,448],
        [2004,366],
        [2005,320],
        [2006,366],
        [2007,432],
        [2008,320],
        [2009,320],
        [2050,320],
        [2051,640],
        [2052,382],
        [2053,624],
        [2054,480],
        [2055,350],
        [2101,320],
        [2102,448],
        [2103,382],
        [2104,480],
        [2105,480],
        [2106,416],
        [2107,512],
        [2108,320],
        [2109,416],
        [2110,432],
        [2111,432],
        [2112,366],
        [2113,398],
        [2114,320],
        [2150,448],
        [2151,320],
        [2152,480],
        [2154,448],
        [2153,544],
        [2155,432],
        [2157,320],
        [2158,448],
        [2159,320],
        [2160,448],
        [2161,576],
        [2162,544],
        [2163,398],
        [2165,544],
        [2166,512],
        [2167,480],
        [2168,544],
        [2169,464],
        [2170,432],
        [2171,320],
        [2172,512],
        [2173,448],
        [2200,382],
        [2201,560],
        [2202,334],
        [2203,350],
        [2204,334],
        [2205,334],
        [2206,560],
        [2207,512],
        [2208,334],
        [2209,560],
        [2211,928],
        [2212,398],
        [2213,398],
        [2214,512],
        [2215,480],
        [2216,480],
        [2217,432],
        [2220,544],
        [2221,512],
        [2222,382],
        [2250,320],
        [2251,480],
        [2252,480],
        [2253,592],
        [2254,334],
        [2255,320],
        [2256,672],
        [2257,334],
        [2258,592],
        [2259,528],
        [2260,320],
        [2261,350],
        [2300,512],
        [2301,512],
        [2302,512],
        [2303,334],
        [2304,512],
        [2305,320],
        [2350,656],
        [2351,320],
        [2352,398],
        [2353,398],
        [2354,320],
        [2355,382],
        [2356,350],
        [2357,464],
        [2358,544],
        [2359,416],
        [2360,448],
        [2361,320],
        [2362,350],
        [2363,384],
        [2364,512],
        [2365,334],
        [2400,366],
        [2401,320],
        [2402,416],
        [2403,416],
        [2404,416],
        [2405,320],
        [2406,382],
        [2450,320],
        [2451,382],
        [2452,640],
        [2453,320],
        [2454,528],
        [2455,448],
        [2456,432],
        [2457,416],
        [2458,320],
        [2500,350],
        [2501,350],
        [2502,366],
        [2503,366],
        [2504,512],
        [2505,448],
        [2506,512],
        [2507,592],
        [2508,432],
        [2509,512],
        [2510,320],
        [2512,320],
        [2513,334],
        [2550,496],
        [2551,398],
        [2552,352],
        [2553,416],
        [2554,464],
        [2600,464],
        [2601,398],
        [2602,382],
        [2603,560],
        [2604,512],
        [2605,606],
        [2606,512],
        [2607,432],
        [2608,320],
        [2650,366],
        [2651,520],
        [2652,448],
        [2653,512],
        [2654,350],
        [2655,416],
        [2656,480],
        [2657,382],
        [2658,398],
        [2659,464],
        [2660,520],
        [2661,480],
        [2700,448],
        [2701,320],
        [2702,624],
        [2703,464],
        [2704,432],
        [2705,320],
        [2706,398],
        [2707,640],
        [2708,448],
        [2709,480],
        [2710,576],
        [2711,624],
        [2712,512],
        [2713,592],
        [2714,608],
        [2715,320],
        [2716,416],
        [2717,528],
        [2718,592],
        [2719,320],
        [2750,432],
        [2751,432],
        [2752,320],
        [2753,448],
        [2754,480],
        [2755,496],
        [2756,334],
        [2771,350],
        [2800,512],
        [2801,480],
        [2802,480],
        [2803,496],
        [2850,496],
        [2851,382],
        [2852,464],
        [2853,512],
        [2854,496],
        [2855,382],
        [2856,382],
        [2900,320],
        [2901,320],
        [2902,320],
        [2903,510],
        [2904,366],
        [2905,448],
        [2906,398],
        [2907,544],
        [2908,320],
        [2909,320],
        [2910,320],
        [2911,480],
        [2912,320],
        [2913,366],
        [2914,320],
        [2915,382],
        [2916,414],
        [2917,320],
        [2918,320],
        [2919,320],
        [2920,320],
        [2921,336],
        [2922,384],
        [2923,688],
        [2924,320],
        [2925,320],
        [2926,320],
        [2927,320],
        [2928,366],
        [2929,320],
        [2930,320],
        [2931,496],
        [2932,334],
        [2933,320],
        [2934,320],
        [2950,320],
        [2951,480],
        [2952,512],
        [2953,320],
        [2954,480],
        [2955,576],
        [3000,320],
        [3001,320],
        [3002,320],
        [3003,320],
        [3004,320],
        [3005,320],
        [3006,320],
        [3007,320],
        [3008,320],
        [3009,320],
        [3010,320],
        [3011,320],
        [3012,320],
        [3050,480],
        [3051,432],
        [3052,382],
        [3053,512],
        [3054,320],
        [3055,398],
        [3056,320],
        [3057,334],
        [3058,320],
        [3059,512],
        [3100,366],
    };

    /// <summary>Left and right margin of camera (because it goes too far), [field#,PSXmargin]</summary>
    public static readonly Dictionary<Int32, Int32> mapCameraMargin = new Dictionary<Int32, Int32>
    {
        //{mapNo,pixels on each side to crop because of scrollable}
        {1051,9},
        {1057,17},
        {1058,16},
        {1060,17},
        {1653,16},
    };
}
